## How to Use This Repository

### Overview
This repository provides scripts and tools for generating, loading, and running **TPC-DS** benchmark queries using DuckDB .

### Components
- **TPC-DS-Tool** — The official TPC-DS data generation tool.  
- **tpcds_gen.sh** — Run locally to generate TPC-DS queries and datasets on the VM.  
- **create_load_script.sh** — Creates `tpcds.db` and `load_data.sql` for DuckDB.  
- **run_queries.sh** — Loads data into `tpcds.db` and executes all TPC-DS queries.  
- **_queries/** — The TPC-DS queries generated by *Charles Tsai*.  
- **Docker-compose.yml** — Initializes Spark and Iceberg for distributed testing.
- **query.py** — Entry point for querying Iceberg in DuckDB; will add DuckLake / Delta support.  
- **tpcds_schema.py** — All TPC-DS table formats defined in PySpark.  
- **setup_iceberg.sh** — Sets up Spark and Iceberg in Docker and loads data to Iceberg format.

### Data
- **1GB Dataset:** [Download here](https://drive.google.com/file/d/1Z2NGxApeZzETB_DGMxRoXMcZaoRuDPMz/view?usp=sharing)

### Example Generate data (or download it)
```bash
# 1. Generate TPC-DS queries and data (run this script from local machine)
./tpcds_gen.sh
```

### Setup iceberg and ducklake
```bash
sudo apt install python3-pip python3.10-venv -y
python3 -m venv my_venv
source my_venv/bin/activate
pip3 install -r requirements.txt
```
0. Put data in /mydata/data1gb
1. [Install docker](https://docs.docker.com/engine/install/ubuntu/)
2. Start spark-iceberg. Copy necessary file. Run script
```bash
./iceberg/setup_iceberg.sh
./ducklake/setup_ducklake.sh
```
3. Query in duckdb
```bash
source my_venv/bin/activate
python3 query.py -i
```
4. stop
sudo docker compose down
